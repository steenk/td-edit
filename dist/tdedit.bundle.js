!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);let o={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"};function r(e){var t,n,i,a,c=Array.prototype.slice.call(arguments,1),l=[];if("string"!=typeof e)return"[object Array]"===Object.prototype.toString.call(e)?r.apply(this,e):e instanceof window.HTMLElement||e instanceof window.SVGElement?(e.evt=p,e.set=d,e.fun=f,e.ins=h,e.css=u,e.query=e.querySelector,e.queryAll=e.querySelectorAll,e.prototype=e,e):void 0;if(!e||/^[A-Za-z][A-Za-z0-9-_\.:#]*$/.test(e)){for(t=e.split(/([\.#])/),i=0;i<t.length;i++)0===i?(a=t[0].split(":"),n=o[a[0]]?window.document.createElementNS(o[a[0]],a[1]||a[0]):window.document.createElement(a[1]||a[0])):n&&"."===t[i-1]?l.push(t[i]):"#"===t[i-1]&&n.setAttribute("id",t[i]);return l.length>0&&n.setAttribute("class",l.join(" ")),s.call(n,c),n.css=u,n.set=d,n.fun=f,n.evt=p,n.ins=h,n.query=n.querySelector,n.queryAll=n.querySelectorAll,n.prototype=n,n}function s(e){var t,n,i,a,c;for(n=0;n<e.length;n++)if((t=e[n])&&t.nodeType)this.appendChild(t);else if("object"==typeof t)if("[object Array]"===Object.prototype.toString.call(t))this.appendChild(r.apply(this,t));else for(a in t)t.hasOwnProperty(a)&&(/^data[A-Z]/.test(a)?(c=a.substr(4).toLowerCase(),this.setAttribute("data-"+c,t[a])):2===(i=a.split(":")).length&&Object.keys(o).indexOf(i[0])>-1?this.setAttributeNS(o[i[0]],i[1],t[a]):this.setAttribute(a,t[a]));else this.appendChild(window.document.createTextNode(String(t)))}function u(e){var t,n,o;for(t in e)if(e.hasOwnProperty(t))if("object"!=typeof e[t])this.style[t]=e[t];else for(n=this.querySelectorAll(t),o=0;o<n.length;o++)u.call(n[o],e[t]);return this}function d(e,t){return this[e]=t,this}function f(e){var t=Array.prototype.slice.call(arguments,1);return this[e].apply(this,t),this}function p(e,t){if(arguments.length>2){var n=Array.prototype.slice.call(arguments,2);this.addEventListener?this.addEventListener(e,(function(e){var o=[e].concat(n);t.apply(this,o)}),!1):this.attachEvent("on"+e,(function(e){var o=[e].concat(n);t.apply(this,o)}))}else this.addEventListener?this.addEventListener(e,t,!1):this.attachEvent("on"+e,t);return this}function h(){return s.call(this,Array.prototype.slice.call(arguments)),this}console.log('$$$: not a valid ident parameter "'+e+'".')}var i,a,c,l;r.version="1.5.4",r.structify=function(e,t){var n,o=null;return 1===e.nodeType&&(n=function(e){var o,r,i,a,c,l=[],s=/id|class|contenteditable/,u=e.localName,d=String(e.getAttribute("class")||"").replace(/\s/g,".");if(d&&(u+="."+d),e.id&&(u+="#"+e.id),l.push(u),e.hasAttributes()){for(r=e.attributes,o={},c=0;c<r.length;c++)s.test(r[c].name)||(o[r[c].name]=r[c].value);Object.keys(o).length>0&&l.push(o)}for(e.normalize(),i=e.childNodes,c=0;c<i.length;c++)3===i[c].nodeType?(a=t?i[c].data.replace(/\s\s*/," ").trim():i[c].data).length>0&&l.push(a):1===i[c].nodeType&&l.push(n(i[c]));return l},o=n(e)),o},r.onReady=function(e){"complete"===window.document.readyState||"interactive"===window.document.readyState?i(e):window.document.addEventListener?window.document.addEventListener("DOMContentLoaded",e,!1):window.document.attachEvent("onreadystatechange",e)},"function"==typeof setImmediate?i=setImmediate:window.setImmediate?i=window.setImmediate:(c=[],l="doNext"+(67108864*Math.random()|0).toString(16),a=function(e){var t,n;e.source===window&&"string"==typeof e.data&&0===e.data.indexOf(l)&&((n=c.shift()).length>0&&(t=n[0].apply(void 0,n.splice(1),!0),c[0]&&1===c[0].length&&c[0].push(t)))},window.postMessage?window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("message",a):window.postMessage=function(e){window.setTimeout((function(){a({source:window,data:e})}),0)},i=function(){var e=Array.prototype.slice.call(arguments);"function"==typeof e[0]&&(c.push(e),window.postMessage(l,"*"))}),r.setImmediate=i,r.appendToDoc=function e(){function t(e){var t;r.onReady((function(){for(n=0;n<o.length;n++)"[object Array]"===Object.prototype.toString.call(o[n])?(t=r.apply(this,o[n]))&&window.document.body.appendChild(t):o[n]instanceof window.Element?window.document.body.appendChild(o[n]):"function"==typeof o[n]&&o[n]();e()}))}var n,o=Array.prototype.slice.call(arguments),a=[];return e.then=function(t){if(e===t)throw new TypeError("Circular reference.");return"function"==typeof t?a.push(t):console.log('$$$: Only functions can be passed to "then()"!'),e},e.catch=function(t){return console.log("$$$: Error occured.",t),e},"undefined"!=typeof Promise?new Promise((function(e,n){try{t(e)}catch(e){n(e)}})):(t((function(){var e;a.forEach((function(t){i((function(){e&&e.then?e.then((function(e){t(e)})):e=t(e)}))}))})),e)},r.query=function(e){return window.document.querySelector(e)},r.queryAll=function(e){return window.document.querySelectorAll(e)};let s={bold:function(e){return["strong",e]},STRONG:"bold",italic:function(e){return["em",e]},EM:"italic",underline:function(e){return["mark",e]},MARK:"underline",cite:function(e){return["cite",e]},paragraph:function(e){return["p",e]},P:"paragraph",code:function(e){return["code",e]},"quote-right":function(e){return["quote",e]},"heading.one":function(e){return["h1",e]},"heading.two":function(e){return["h2",e]},"heading.three":function(e){return["h3",e]},"heading.four":function(e){return["h4",e]},"heading.five":function(e){return["h5",e]},"heading.six":function(e){return["h6",e]},angry:function(e){return e}};let u={quote:"quote-right"};function d(e,t,n){for(var o=!1,i=1===e.nodeType?e:e.parentElement;!i.classList.contains("td-edit-textarea");)s[i.tagName]===t&&(o=!0),i=i.parentNode;if(n[t]&&!o){console.log(t+" should be created");let e=document.getSelection(),n=e.getRangeAt(0),o=r(s[t]("âƒ—"));n.insertNode(o),e.selectAllChildren(o)}return!n[t]&&o&&console.log(t+" should be removed"),o}var f={run:function(e,t){if(t=u[t]||t,console.log("run",e,t),s[t]){let n=document.getSelection(),o=e.selection;if(console.log(o.type),!o.focusNode||o.focusNode.length<o.focusOffset)return;if(n.setBaseAndExtent(o.anchorNode,o.anchorOffset,o.focusNode,o.focusOffset),n.rangeCount){console.log(n.rangeCount);let o=n.getRangeAt(0);if("Range"===n.type){let e=s[t](n.toString());return o.deleteContents(),o.insertNode(r(e)),void n.empty()}"Caret"===n.type&&console.log(e.toolbarId)}}},check:function(e){return e=u[e]||e,s[e]?e:"angry"},mapToFA:function(e){let t=s[e];if(t)return".fa-"+t},remove:function(e,t){document.getSelection();let n=e.selection.anchorNode.parentElement;s[n.tagName]&&s[n.tagName]===t&&n.parentNode.replaceChild(e.selection.anchorNode,n)},setStyle:function(e,t){console.log(t);let n=document.getSelection(),o=e.selection;n.setBaseAndExtent(o.anchorNode,o.anchorOffset,o.focusNode,o.focusOffset);for(let e in t)d(o.anchorNode,e,t)}};const p=new Event("change");function h(e,t){if("I"===e.target.tagName){let n=e.target,o=document.getElementById(t),r=o.parentElement.querySelector(".td-edit-textarea"),i=n.getAttribute("title");n.classList.contains("active")?(n.classList.remove("active"),f.remove(r,i)):"Caret"===r.selection.type?(n.classList.toggle("active"),f.setStyle(r,function(e){let t=e.queryAll("i"),n={};return Array.from(t).forEach(e=>{n[e.getAttribute("title")]=e.classList.contains("active")}),n}(o))):"Range"===r.selection.type&&f.run(r,i)}}function y(e,t,n){!function(e){let t=e.queryAll(".active");Array.from(t).forEach(e=>{e.classList.remove("active")})}(n);let o=document.getSelection();if(!o.anchorNode)return void console.log("no anchor",o.type);for(let e of["anchorNode","focusNode","anchorOffset","focusOffset","isCollapsed","rangeCount","type"])t.selection[e]=o[e];let r=o.anchorNode.parentNode;if(!r.classList.contains("td-edit-textarea")){let e=f.mapToFA(r.tagName),t=n.querySelector(e);t&&t.classList.add("active")}}var g={version:"0.2.1",init:function(e){e=e||{tools:["bold","italic","underline","paragraph","code","quote","heading.one","heading.two","heading.three","list","list-ol","steen"]};let t=r.queryAll(".td-rich-editor");Array.from(t).forEach(e=>{r(e).ins(["div.td-edit-toolbar"],["div.td-edit-textarea",{contenteditable:!0}])});let n=r.queryAll(".td-edit-toolbar");Array.from(n).forEach(t=>{let n="TB"+1e18*Math.random();r(t).id=n,e.tools.forEach(e=>{let n=f.check(e);t.ins(["i.fas.fa-"+n,{title:e}])}),t.evt("click",h,n)});let o=r.queryAll(".td-edit-textarea");Array.from(o).forEach(e=>{e.selection={};let t=e.parentElement.querySelector(".td-edit-toolbar");e.toolbarId=t.id,r(e).evt("change",y,e,t),e.evt("keyup",t=>{e.dispatchEvent(p)}),e.evt("click",t=>{e.dispatchEvent(p)})})}};document.onreadystatechange=function(){"complete"===document.readyState&&g.init()}}]);